<app-breadcrumb pageURL="" pageSubText="" icon="discount" redirectionURL='/discount/add'
  [pageText]="'discountListPage.pageText' | translate" [addButtonText]="'discountListPage.addText' | translate "></app-breadcrumb>


<div class="page-wrapper">
  <div class="custom-card event-list">
    <div class="d-flex flex-wrap align-items-center justify-content-between mb-2">
      <strong class="mb-1" *ngIf="dataSource">
        {{ "discountListPage.manageDiscountText" | translate }} : {{ dataSource!.filteredData!.length }}
      </strong>
      <div class="form-field w-100 sm-w-auto mb-1">
        <mat-form-field appearance="outline">
          <input matInput placeholder="Search" [(ngModel)]="filterValue" (keyup)="applyFilter($event)"
            (keydown)="$event.stopPropagation()" />
        </mat-form-field>
      </div>
    </div>
    <!-- end -->
    <div class="table-wrapper" *ngIf="dataSource">
      <div class="table-scroll">
        <table class="w-100" mat-table [dataSource]="dataSource" matSort>
          <ng-container matColumnDef="title">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.summaryText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row; index as i;" [attr.data-label]="'discountListPage.summaryText' | translate">
              {{ row.title }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="discount_code">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.discountCodeText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row" [attr.data-label]="'discountListPage.discountCodeText' | translate">
              {{ row.discount_code }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="discount_type">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.discountTypeText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row" [attr.data-label]="'discountListPage.discountTypeText' | translate">
              {{ row.discount_type }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="discount_value">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.discountValueText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row" [attr.data-label]="'discountListPage.discountValueText' | translate">
              {{ row.discount_type === 'flat' ? 'â‚¹' : '' }}{{ row.discount_value }}{{ row.discount_type === 'percentage' ? '%' : '' }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="max_avail_limit_of_coupon_code">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.redeemLimitText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row" [attr.data-label]="'discountListPage.redeemLimitText' | translate">
              {{ row.max_avail_limit_of_coupon_code }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="max_avail_limit_per_user">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.validPerUserText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row" [attr.data-label]="'discountListPage.validPerUserText' | translate">
              {{ row.max_avail_limit_per_user }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "discountListPage.statusText" | translate }}
            </th>
            <td mat-cell *matCellDef="let row" [attr.data-label]="'discountListPage.statusText' | translate">
              {{ row.is_published === true ? "Published" : "Draft" }}
            </td>
          </ng-container>
          <!-- end -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef>
              {{ "discountListPage.actionText" | translate }}
            </th>
            <td mat-cell class="action-button" *matCellDef="let row" [attr.data-label]="'discountListPage.actionText' | translate">
              <div class="d-flex">
                <button class="edit-button" mat-icon-button (click)="editDiscount(row.uuid , 'view')" *ngIf="row.is_published">
                  <mat-icon>{{ "iconList.visibilityIcon" | translate }}</mat-icon>
                </button>
                <button class="edit-button" mat-icon-button (click)="editDiscount(row.uuid , 'edit')" *ngIf="!row.is_published">
                  <mat-icon>{{ "iconList.editIcon" | translate }}</mat-icon>
                </button>
                <button class="delete-button" mat-icon-button (click)="deleteDiscount(row.uuid , row.discount_code)">
                  <mat-icon>{{ "iconList.deleteIcon" | translate }}</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>
          <!-- end -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"> </tr>

          <tr class="mat-mdc-row" *matNoDataRow>
            <td class="mat-mdc-cell text-center" colspan="6">No Data to Display</td>
          </tr>
        </table>
      </div>
      <mat-paginator [pageSizeOptions]="pagination"></mat-paginator>
    </div>
  </div>
  <!-- end -->
</div>
