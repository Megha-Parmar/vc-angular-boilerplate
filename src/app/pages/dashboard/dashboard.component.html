<app-breadcrumb pageURL="" pageSubText="" [icon]="'iconList.dashboardIcon' | translate" redirectionURL=""
  [pageText]="'dashboardPage.pageText' | translate" addButtonText=""></app-breadcrumb>

<div class="page-contain">
  <div class="d-flex flex-wrap statistics" *ngIf="dashboardDetails">
    <div class="p-8">
      <mat-card class="custom-card-board align-items-center">
        <p class="count font-primary font-bold">
          ₹{{ dashboardDetails.total_revenue | number : "1.2-2" }}
        </p>
        <p class="font-14 title-txt font-bold m-t-8">
          {{ "DASHBOARD.totalRevenue" | translate }}
        </p>
        <!-- <div class="icon-box"> <mat-icon>supervised_user_circle</mat-icon></div> -->
      </mat-card>
    </div>
    <div class="p-8">
      <mat-card class="custom-card-board align-items-center">
        <p class="count font-primary font-bold">
          {{ dashboardDetails.total_bookings }}
        </p>
        <p class="font-14 title-txt font-bold m-t-8">
          {{ "DASHBOARD.totalBooking" | translate }}
        </p>
        <!-- <div class="icon-box"> <mat-icon>supervised_user_circle</mat-icon></div> -->
      </mat-card>
    </div>
    <div class="p-8">
      <mat-card class="custom-card-board align-items-center">
        <p class="count font-primary font-bold">
          {{ dashboardDetails.total_events }}
        </p>
        <p class="font-14 title-txt font-bold m-t-8">
          {{ "DASHBOARD.totalEvents" | translate }}
        </p>
        <!-- <div class="icon-box"> <mat-icon>supervised_user_circle</mat-icon></div> -->
      </mat-card>
    </div>
    <div class="p-8">
      <mat-card class="custom-card-board align-items-center">
        <p class="count font-primary font-bold">
          {{ dashboardDetails.total_member }}
        </p>
        <p class="font-14 title-txt font-bold m-t-8">
          {{ "DASHBOARD.totalMember" | translate }}
        </p>
        <!-- <div class="icon-box"> <mat-icon>supervised_user_circle</mat-icon></div> -->
      </mat-card>
    </div>
    <div class="p-8">
      <mat-card class="custom-card-board align-items-center">
        <p class="count font-primary font-bold">
          {{ dashboardDetails.pos_mobile_active_staff }}
        </p>
        <p class="font-14 title-txt font-bold m-t-8">
          {{ "DASHBOARD.activePOSMobile" | translate }}
        </p>
        <!-- <div class="icon-box"> <mat-icon>supervised_user_circle</mat-icon></div> -->
      </mat-card>
    </div>
    <div class="p-8">
      <mat-card class="custom-card-board align-items-center">
        <p class="count font-primary font-bold">
          {{ dashboardDetails.pos_desktop_active_staff }}
        </p>
        <p class="font-14 title-txt font-bold m-t-8">
          {{ "DASHBOARD.activeAdmissionDevice" | translate }}
        </p>
        <!-- <div class="icon-box"> <mat-icon>supervised_user_circle</mat-icon></div> -->
      </mat-card>
    </div>
  </div>
  <div class="d-flex flex-wrap"
    *ngIf="dashboardDetails && (dashboardDetails.total_offline_bookings || dashboardDetails.total_online_bookings)">
    <div class="w-33 p-8">
      <mat-card class="custom-card-board h-100 justify-content-around">
        <p class="font-14 font-bold text-gray-200 mb-2">
          {{ "DASHBOARD.totalBooking" | translate }}
        </p>
        <!-- <p class="font-10 font-bold text-black-100 mb-20">Last 3 month update</p> -->
        <div id="chart">
          <apx-chart [series]="bookingChart.series" [chart]="bookingChart.chart" [dataLabels]="bookingChart.dataLabels"
            [plotOptions]="bookingChart.plotOptions" [yaxis]="bookingChart.yaxis" [xaxis]="bookingChart.xaxis"
            [labels]="bookingChart.labels" [fill]="bookingChart.fill" [title]="bookingChart.title"></apx-chart>
        </div>
      </mat-card>
    </div>
    <div class="w-33 p-8">
      <mat-card class="custom-card-board h-100 justify-content-around">
        <p class="font-14 font-bold text-gray-200 mb-2">
          {{ "DASHBOARD.totalEarning" | translate }}
        </p>
        <!-- <p class="font-12 font-bold text-black-100 mb-20">Last 3 month update</p> -->
        <div id="chart">
          <apx-chart [series]="earningChart.series" [chart]="earningChart.chart" [dataLabels]="earningChart.dataLabels"
            [plotOptions]="earningChart.plotOptions" [yaxis]="earningChart.yaxis" [xaxis]="earningChart.xaxis"
            [labels]="earningChart.labels" [fill]="earningChart.fill" [title]="earningChart.title"></apx-chart>
        </div>
      </mat-card>
    </div>
    <div class="w-33 p-8">
      <mat-card class="custom-card-board h-100 justify-content-around">
        <p class="font-14 font-bold text-gray-200 mb-2">
          {{ "DASHBOARD.visitorGraph" | translate }}
        </p>
        <div id="chart" *ngIf="visitorChart">
          <apx-chart [series]="visitorChart.series" [chart]="visitorChart.chart" [dataLabels]="visitorChart.dataLabels"
            [plotOptions]="visitorChart.plotOptions" [yaxis]="visitorChart.yaxis" [xaxis]="visitorChart.xaxis"
            [labels]="visitorChart.labels" [fill]="visitorChart.fill" [title]="visitorChart.title"></apx-chart>
        </div>
      </mat-card>
    </div>
  </div>
  <div class="p-8">
    <mat-card class="custom-card-board table-wrapper">
      <p class="font-bold text-gray-200 font-14 mb-2">
        {{ "DASHBOARD.recentOrders" | translate }}
      </p>
      <div class="table-scroll">
        <table mat-table [dataSource]="orderDataSource" #orderSort="matSort" matSort class="w-100">
          <ng-container matColumnDef="order_id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.orderId" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              {{ row?.order_id || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="transaction_id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.transactionId" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              {{ row?.transaction_id || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.name" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              <span class="capitalize">{{ row?.name || "-" }}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.email" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              {{ row?.email || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="phone_number">
            <th class="center" mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.phoneNumber" | translate }}
            </th>
            <td class="center" mat-cell *matCellDef="let row">
              {{ row?.phone_number || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="payable_amount">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="right">
              {{ "ORDER_REPORT.amountPaid" | translate }}
            </th>
            <td class="right" mat-cell *matCellDef="let row">
              ₹{{ row?.payable_amount || (0 | number : "1.2-2") }}
            </td>
          </ng-container>

          <ng-container matColumnDef="discount_amount">
            <th class="right" mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.discountAmount" | translate }}
            </th>
            <td class="right" mat-cell *matCellDef="let row">
              ₹{{ row?.discount_amount || (0 | number : "1.2-2") }}
            </td>
          </ng-container>

          <ng-container matColumnDef="payment_method">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="right">
              {{ "ORDER_REPORT.paymentMethod" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              <span class="capitalize">
                {{ row?.payment_method || "-" }}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="order_from">
            <th class="right" mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.orderFrom" | translate }}
            </th>
            <td class="right" mat-cell *matCellDef="let row">
              <span class="capitalize"> {{ row?.order_from === "offline" ? "POS" : "Web" }} </span>
            </td>
          </ng-container>

          <ng-container matColumnDef="total_tickets">
            <th class="center" mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "ORDER_REPORT.totalTickets" | translate }}
            </th>
            <td class="center" mat-cell *matCellDef="let row">
              {{ row?.total_tickets || "-" }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="orderListColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: orderListColumns"></tr>

          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell no-data p-t-25" colspan="12">{{ "DASHBOARD.noData" | translate }}</td>
          </tr>
        </table>
      </div>
      <!-- <mat-paginator [pageSizeOptions]="[5, 10]"></mat-paginator> -->
    </mat-card>
  </div>
  <div class="p-8">
    <mat-card class="custom-card-board table-wrapper">
      <p class="font-bold text-gray-200 font-14 mb-2"> {{ 'EVENT_LIST.onGoingEventList' | translate }}</p>
      <div class="table-scroll">
        <table class="w-100" mat-table [dataSource]="eventOnGoingDataSource" #eventSort="matSort" matSort>
          <ng-container matColumnDef="event_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.eventName" | translate }}
            </th>
            <td mat-cell *matCellDef="let row; index as i">
              {{ row?.event_name || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="event_type">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.eventType" | translate }}
            </th>
            <td mat-cell *matCellDef="let row; index as i">
              {{ row?.event_type === "slotwise" ? "Slots" : "Full Day" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="venue">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.eventLocation" | translate }}
            </th>
            <td mat-cell *matCellDef="let row; index as i">
              {{ row?.venue || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="start_date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.date" | translate }}
            </th>
            <td mat-cell *matCellDef="let row; index as i">
              {{ (row?.start_date | date : dateFormat) || "" }} - {{ (row?.end_date | date : dateFormat) || "" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="total_sold_ticket">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.ticketSold" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              {{ row?.total_sold_ticket || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="total_earnings">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.ticketEarnings" | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              ₹{{ row?.total_earnings || (0 | number : "1.2-2") }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="eventListColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: eventListColumns"></tr>
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell no-data p-t-25" colspan="6">{{ "DASHBOARD.noData" | translate }}</td>
          </tr>
        </table>
      </div>
      <!-- <mat-paginator [pageSizeOptions]="[5,10]"></mat-paginator> -->
    </mat-card>
  </div>
  <div class="p-8">
    <mat-card class="custom-card-board table-wrapper">
      <p class="font-bold text-gray-200 font-14 mb-2">{{ 'EVENT_DETAILS.todaysBooking' | translate }}</p>
      <div class="table-scroll">
        <table class="w-100" mat-table [dataSource]="todaysBookingDataSource" #bookingSort="matSort" matSort>
          <ng-container matColumnDef="booking_id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ 'EVENT_DETAILS.bokingId' | translate }}
            </th>
            <td mat-cell *matCellDef="let row; index as i">
              {{ row?.booking_id || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="customer_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ 'EVENT_DETAILS.customerName' | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              {{ row?.customer_name || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="customer_email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'EVENT_DETAILS.email' | translate }}</th>
            <td mat-cell *matCellDef="let row">
              {{ row?.customer_email || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="customer_phone_number">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ 'EVENT_DETAILS.mobileNumber' | translate }}
            </th>
            <td mat-cell *matCellDef="let row">
              {{ row?.customer_phone_number || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="event_name">
            <th class="center" mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ "EVENT_LIST.eventName" | translate }}
            </th>
            <td class="center" mat-cell *matCellDef="let row">
              {{ row?.event_name || "-" }}
            </td>
          </ng-container>

          <ng-container matColumnDef="time">
            <th class="center" mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ 'EVENT_DETAILS.time_slot' | translate }}
            </th>
            <td class="center" mat-cell *matCellDef="let row">
              {{ row?.time_slots_starttime || "" }} - {{ row?.time_slots_endtime || "" }}
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="ticketColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: ticketColumns"></tr>
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell no-data p-t-25" colspan="6">{{ "DASHBOARD.noData" | translate }}</td>
          </tr>
        </table>
      </div>
      <!-- <mat-paginator [pageSizeOptions]="[5,10]"></mat-paginator> -->
    </mat-card>
  </div>
</div>